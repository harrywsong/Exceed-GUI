<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>디스코드 봇 관리 UI</title>
    <!-- Link to your custom CSS file -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Font Awesome for icons (e.g., for control panel buttons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Chart.js for graphs and charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <h1><i class="fab fa-discord"></i> 디스코드 봇 관리</h1>

        <!-- 대시보드 섹션 -->
        <div class="card dashboard">
            <h2><i class="fas fa-tachometer-alt"></i> 대시보드 개요</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <h3>봇 상태</h3>
                    <p>상태: <span id="status" class="status-indicator loading">로딩 중...</span></p>
                    <p>업타임: <span id="uptime">로딩 중...</span></p>
                    <p>지연 시간: <span id="latency">로딩 중...</span></p>
                </div>
                <div class="stat-item">
                    <h3>빠른 통계</h3>
                    <p>오늘 사용된 명령어: <span id="commands-today">로딩 중...</span></p>
                    <p>활성 사용자: <span id="active-users">로딩 중...</span></p>
                    <p>서버 수: <span id="server-count">로딩 중...</span></p>
                </div>
            </div>
        </div>

        <!-- 봇 제어판 섹션 -->
        <div class="card bot-control-panel">
            <h2><i class="fas fa-gamepad"></i> 봇 제어판</h2>
            <div class="control-buttons">
                <button id="restart-bot-btn" class="control-btn"><i class="fas fa-redo"></i> 봇 재시작</button>
                <button id="reload-cogs-btn" class="control-btn"><i class="fas fa-sync-alt"></i> Cog 재로드</button>
                <button id="update-git-btn" class="control-btn"><i class="fas fa-code-branch"></i> Git에서 업데이트</button>
            </div>
            <p id="control-status-message" class="message"></p>
        </div>

        <!-- 공지 보내기 섹션 -->
        <div class="card announcement-sender">
            <h2><i class="fas fa-bullhorn"></i> 공지 보내기</h2>
            <div class="form-group">
                <label for="announcement-message">메시지:</label>
                <textarea id="announcement-message" rows="4" placeholder="공지 메시지를 입력하세요"></textarea>
            </div>
            <div class="form-group">
                <label for="announcement-channel">채널 ID (예: 123456789012345678):</label>
                <input type="text" id="announcement-channel" placeholder="디스코드 채널 ID를 입력하세요">
            </div>
            <button id="send-announcement-btn"><i class="fas fa-paper-plane"></i> 공지 보내기</button>
            <p id="announcement-status-message" class="message"></p>
        </div>

        <!-- 명령어 사용 통계 섹션 -->
        <div class="card command-stats">
            <h2><i class="fas fa-chart-bar"></i> 명령어 사용 통계</h2>
            <div class="chart-container">
                <canvas id="commandUsageChart"></canvas>
            </div>
            <div class="stats-details">
                <h3>가장 많이 사용된 명령어</h3>
                <ul id="top-commands-list">
                    <!-- 상위 명령어는 JS에 의해 채워집니다 -->
                </ul>
            </div>
        </div>

        <!-- 실시간 로그 뷰어 섹션 -->
        <div class="card logs-viewer">
            <h2><i class="fas fa-clipboard-list"></i> 실시간 로그</h2>
            <div class="log-controls">
                <input type="text" id="log-filter" placeholder="로그 필터링...">
                <select id="log-level-filter">
                    <option value="all">모든 레벨</option>
                    <option value="info">정보</option>
                    <option value="warn">경고</option>
                    <option value="error">오류</option>
                </select>
                <button id="clear-logs-btn"><i class="fas fa-eraser"></i> 뷰 지우기</button>
                <button id="download-logs-btn"><i class="fas fa-download"></i> 다운로드</button>
            </div>
            <div class="log-output" id="log-output">
                <!-- 로그 메시지는 JS에 의해 여기에 추가됩니다 -->
            </div>
        </div>

        <!-- 봇 설정 편집기 섹션 -->
        <div class="card config-editor">
            <h2><i class="fas fa-cogs"></i> 봇 설정 편집기</h2>
            <div id="config-display">
                <p>설정 로딩 중...</p>
            </div>
            <p id="config-status-message" class="message"></p>
            <p class="note">⚠️ 이 섹션은 현재 읽기 전용입니다. `.env` 값을 직접 편집하려면 서버에 접근해야 합니다.</p>
        </div>

        <!-- 리액션 역할 편집기 섹션 -->
        <div class="card reaction-roles-editor">
            <h2><i class="fas fa-hand-pointer"></i> 리액션 역할 편집기</h2>

            <h3>새 리액션 역할 추가</h3>
            <div class="form-group">
                <label for="rr-message-id">메시지 ID:</label>
                <input type="text" id="rr-message-id" placeholder="리액션 역할을 추가할 메시지 ID">
            </div>
            <div class="form-group">
                <label for="rr-channel-id">채널 ID:</label>
                <input type="text" id="rr-channel-id" placeholder="메시지가 있는 채널 ID">
            </div>
            <div class="form-group">
                <label for="rr-emoji">이모지 (예: 👍 또는 <:custom_emoji:123456789>):</label>
                <input type="text" id="rr-emoji" placeholder="이모지 (유니코드 또는 사용자 지정 이모지)">
            </div>
            <div class="form-group">
                <label for="rr-role-id">역할 ID:</label>
                <input type="text" id="rr-role-id" placeholder="부여할 역할 ID">
            </div>
            <button id="add-reaction-role-btn"><i class="fas fa-plus-circle"></i> 리액션 역할 추가</button>
            <p id="add-rr-status-message" class="message"></p>

            <h3 class="mt-4">기존 리액션 역할</h3>
            <div class="table-container">
                <table id="reaction-roles-table">
                    <thead>
                        <tr>
                            <th>메시지 ID</th>
                            <th>채널 ID</th>
                            <th>이모지</th>
                            <th>역할 ID</th>
                            <th>액션</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 리액션 역할은 JS에 의해 여기에 채워집니다 -->
                        <tr><td colspan="5">리액션 역할 로딩 중...</td></tr>
                    </tbody>
                </table>
            </div>
            <p id="list-rr-status-message" class="message"></p>
        </div>

    </div>

    <!-- Link to your custom JavaScript file -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
